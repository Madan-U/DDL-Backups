-- Object: PROCEDURE citrus_usr.pr_ins_upd_dps8_pc22
-- Server: 10.253.33.227 | DB: DMAT
--------------------------------------------------


CREATE  proc [citrus_usr].[pr_ins_upd_dps8_pc22]
as
begin 

update s8 
set s8.PURPOSECODE22=b9.PURPOSECODE22
,s8.FILLER1=b9.FILLER1
,s8.LINK_STATUS=b9.LINK_STATUS
,s8.FILLER2=b9.FILLER2
,s8.EXCHANGE_ID=b9.EXCHANGE_ID
,s8.UCC=b9.UCC
,s8.SEGMENT_CODE=b9.SEGMENT_CODE
,s8.CM_ID=b9.CM_ID
,s8.TM_CODE=b9.TM_CODE
from dps8_pc22 s8 , dpb9_pc22 b9 
where  s8.boid = b9.BOID
and s8.EXCHANGE_ID=B9.EXCHANGE_ID
and s8.SEGMENT_CODE= B9.SEGMENT_CODE
and s8.ucc =B9.ucc
and s8.CM_ID= B9.CM_ID
and s8.TM_CODE= B9.TM_CODE
 
INSERT INTO DPS8_PC22 (	PURPOSECODE22
,	FILLER1
,	LINK_STATUS
,	FILLER2
,	EXCHANGE_ID
,	UCC
,	SEGMENT_CODE
,	CM_ID
,	TM_CODE
,	BOId
,	TransSystemDate

)
SELECT 	PURPOSECODE22
,	FILLER1
,	LINK_STATUS
,	FILLER2
,	EXCHANGE_ID
,	UCC
,	SEGMENT_CODE
,	CM_ID
,	TM_CODE
,	BOId
,	TransSystemDate

 FROM DPB9_PC22 B9 
 WHERE NOT EXISTS (SELECT 1 FROM DPS8_PC22 S8 WHERE 
  S8.BOID = B9.BOID 
 AND s8.EXCHANGE_ID=B9.EXCHANGE_ID
and s8.SEGMENT_CODE= B9.SEGMENT_CODE
and s8.ucc=B9.ucc
and s8.CM_ID= B9.CM_ID
and s8.TM_CODE= B9.TM_CODE)

end

GO
