-- Object: VIEW citrus_usr.Synergy_Client_Master_fordump_test
-- Server: 10.253.33.227 | DB: DMAT
--------------------------------------------------




CREATE  VIEW [citrus_usr].[Synergy_Client_Master_fordump_test]    
AS    
SELECT     
convert(varchar (16),boid )   CM_CD,    
convert(varchar (100),Name) CM_NAME,    
convert(varchar (20),MiddleName) CM_MIDDLENAME,    
convert(varchar (20),SearchName) CM_LASTNAME,    
convert(varchar (10),Title) CM_TITLE,    
convert(varchar (10),Suffix) CM_SUFFIX,    
convert(varchar (36),Addr1) CM_ADD1,    
convert(varchar (36),Addr2) CM_ADD2,    
convert(varchar (36),Addr3) CM_ADD3,    
convert(varchar (25),City )CM_CITY,    
convert(varchar (25),State) CM_STATE,    
convert(varchar (25),Country )CM_COUNTRY,    
convert(varchar (10),PinCode) CM_PIN,    
convert(varchar (1),PriPhInd) CM_PHONEINDICATOR,    
convert(varchar (17),PriPhNum) CM_TELE1,    
convert(varchar (1),AltPhind) CM_PHONEINDICATOR2,    
convert(varchar (17),AddPh) CM_TELE2,    
convert(varchar (100),AddPh )CM_TELE3,    
convert(varchar (17),Fax )CM_FAX,    
convert(varchar (15),PriPhNum) CM_MOBILE,    
convert(varchar (15), ITCircle) CM_ITCIRCLE,    
convert(varchar (50), EMailId) CM_EMAIL,    
CM_SECH_NAME=CONVERT(VARCHAR(100),(SELECT TOP 1 Name FROM dps8_pc2 B WHERE B.BOId=C.BOID )),    
CM_THIH_NAME=CONVERT(VARCHAR(100),(SELECT TOP 1 Name FROM dps8_pc3 D WHERE C.BOId=D.BOID )),    
CM_DATEOFMATURITY='',    
convert(varchar (10), DPIntRefNum) CM_DPINTREFNO,    
convert(varchar (8), SUBSTRING (DateOfBirth , 3 ,2) + LEFT(DateOfBirth ,2)+RIGHT (DateOfBirth,2) )  CM_DATEOFBIRTH,    
convert(varchar (4), Occupation) CM_OCCUPATION,    
convert(varchar (10),  BOCustType) CM_ACCTYPE,    
convert(varchar (2), BOAcctStatus) CM_ACTIVE,    
convert(varchar (4), BOSubStatus) CM_CLIENTTYPE,    
convert(varchar (1), ConfWaived) CM_CONFIRMATIONWAIVED,    
convert(numeric(5,2),SecAccCd ) CM_SECURITYCODE,    
convert(varchar (30), RBIRefNum) CM_RBIREFNO,    
convert(varchar (8),RIGHT (RBIAppDt,4) +'-'+SUBSTRING (RBIAppDt , 3 ,2) +'-'+ LEFT(RBIAppDt ,2))  CM_RBIAPPDATE,    
convert(varchar (24), SEBIRegNum) CM_SEBIREGNO,    
convert(varchar (40),BenTaxDedStat) CM_TAXDEDUCTION,    
cast((case when ClCorpId ='' then '0' else ClCorpId end) as numeric (5,2)) CM_CCID,    
convert(varchar (8),ClMemId) CM_CMID,    
convert(numeric(5,2),StockExch )CM_STOCKEXCHANGE,    
convert(varchar (8),TradingId )CM_TRADINGID,    
convert(varchar (2),BOStatCycleCd )CM_BOSTATEMENTCYCLE,    
DivBankCd CM_MICR,    
CM_BANKNAME = (SELECT TOP 1 convert(varchar(100), BANM_NAME )   FROM BANK_MSTR WHERE BANM_BRANCH  =DivIFScd)  , 
convert(varchar(12),DivIFScd ) CM_BANKBRANCHNO,    
convert(varchar(20),DivBankAcctNo ) CM_BANKACTNO,    
convert(numeric(5,2),0 ) CM_BANKCCY,    
convert(varchar (12),DivBankCd) CM_DIVBANKCODE,    
convert(varchar (12),DivIFScd) CM_DIVBRANCHNO,    
convert(varchar (20),DivBankAcctNo) CM_DIVBANKACNO,    
convert(varchar,DivBankCurr) CM_DIVBANKCCY,    
CM_POAID=(SELECT TOP 1 POARegNum FROM dps8_pc5 B WHERE B.BOId=C.BOID ),    
CM_POANAME=(SELECT TOP 1 poam_name1  FROM POA_REG B WHERE B.BOId=C.BOID ),    
''CM_PWD,    
convert(varchar (8),SUBSTRING (BOActDt , 3 ,2) + LEFT(BOActDt ,2)+RIGHT (BOActDt,2) ) CM_OPENDATE,    
convert(varchar (8), SUBSTRING (ClosDt , 3 ,2) + LEFT(ClosDt ,2)+RIGHT (ClosDt,2) ) CM_ACC_CLOSUREDATE,    
--convert(varchar (8),ClosDt) CM_ACC_CLOSUREDATE,    
convert(varchar(6),NULL ) CM_BRCODE,    
convert(varchar(6),NULL ) CM_BRBOFFCODE,    
convert(varchar (3),GroupCd ) CM_GROUPCD,    
convert(varchar(3),NULL ) CM_FAMILYCD,    
CM_CHGSSCHEME=LEFT((SELECT TOP 1 BROM_DESC FROM BROKERAGE_MSTR,DP_ACCT_MSTR,CLIENT_DP_BRKG WHERE DPAM_SBA_NO=C.BOId AND DPAM_ID=CLIDB_DPAM_ID AND CLIDB_BROM_ID =BROM_ID ),10),    
convert(varchar(1),NULL ) CM_BILLCYCLE,    
CONVERT(VARCHAR(10),NULL ) CM_STATEMENTS,    
convert(varchar(1),NULL ) CM_BILLFLAG,    
convert(varchar (16),boid ) CM_BILLCODE,    
convert(varchar (16),boid )CM_COLLECTIONCODE,    
convert(numeric,NULL ) CM_ALLOWCREDIT,    
CONVERT(VARCHAR(1),NULL ) CM_UPFRONt,    
CONVERT(VARCHAR(8),NULL ) CM_LASTBILL,  
CONVERT(VARCHAR(1),NULL ) CM_KEEPSETTLEMENT,    
convert(numeric(5,2),NULL) CM_FRE_TRX,    
convert(numeric(5,2),NULL ) CM_FRE_HOLD,    
convert(numeric(5,2),NULL ) CM_FRE_BILL,    
CM_BLSAVINGCD= (SELECT TOP 1 DPAM_BBO_CODE FROM DP_ACCT_MSTR WHERE C.BOId=DPAM_SBA_NO) ,    
' ' CM_AMTMNTDT,    
convert(numeric,'0') CM_UPDATEBAL,    
convert(numeric(5,2),'0') CM_SCHEDULE,    
convert(numeric,'0') CM_OPENINGBAL,    
' ' CM_FREEZEDT,    
MKRDT= 'N',--(SELECT TOP 1 DPAM_CREATED_DT FROM DP_ACCT_MSTR WHERE C.BOId=DPAM_SBA_NO) ,    
MKRID= CONVERT(vARCHAR(8),(SELECT TOP 1 DPAM_CREATED_BY FROM DP_ACCT_MSTR WHERE C.BOId=DPAM_SBA_NO)) ,    
convert(varchar (1),FrzSusFlg )CM_FREEZEYN,    
' ' CM_FREEZEREASON,    
convert(varchar (4),ProdCode )CM_PRODUCTCD,    
NULL MKRTM,    
CONVERT(VARCHAR(1),NULL )  CM_REMISSER,    
CM_POAFORPAYIN = ISNULL((SELECT DISTINCT 'Y'  FROM DPS8_PC5 WHERE BOID= C.BOID AND MasterPOAId='2203320000000014'),'N') ,
CM_POAREGDATE =(SELECT convert(varchar (8),SUBSTRING (MAX(EffFormDate) , 3 ,2) + LEFT(MAX(EffFormDate) ,2)+RIGHT (MAX(EffFormDate),2) ) FROM DPS8_PC5 WHERE BOID= C.BOID AND MasterPOAId='2203320000000014') ,    
convert(varchar (15),UnqIdenNum ) FIRST_HOLD_UID,    
 '' SECOND_HOLD_UID,    
 ''  THIRD_HOLD_UID,    
convert(varchar (1),AnnlRep ) RGESS_FLAG,    
 '' DIGI_ANNUAL,    
convert(varchar (1),Filler7) PSI_FLAG,    
convert(varchar (1),Filler8) RTA_FLAG,    
convert(varchar (1),Filler9) BSDA_FLAG    
FROM dps8_pc1 c WITH(NOLOCK)

GO
