-- Object: PROCEDURE citrus_usr.PR_UCC_PARAMETER_REMEDYOFFMKT
-- Server: 10.253.33.227 | DB: DMAT
--------------------------------------------------


CREATE PROCEDURE [CITRUS_USR].[PR_UCC_PARAMETER_REMEDYOFFMKT](@PA_FROM_DT       VARCHAR(100)      
,@PA_TO_DT         VARCHAR(100)      
,@PA_EXCH_CD       VARCHAR(10)      
,@PA_EXCH_SEG_CD   VARCHAR(15)      
,@PA_TAB           CHAR(50)   
,@PA_EXCSM_ID	   VARCHAR(15)   
,@PA_REF_CUR       VARCHAR(8000)  OUTPUT      
)      
AS      
BEGIN      
--


  
-- SET @PA_FROM_DT = @PA_FROM_DT + +' 00:00:00.000'
SET @PA_TO_DT   = @PA_TO_DT + +' 23:59:59.999'
DECLARE @L_DPM_ID INT
SELECT @L_DPM_ID = DPM_ID FROM DP_MSTR WHERE DEFAULT_DP=DPM_EXCSM_ID AND DPM_DELETED_IND=1 
AND DPM_EXCSM_ID=CITRUS_USR.FN_SPLITVAL_BY(@PA_EXCSM_ID,2,'|*~|')       

SELECT * FROM ERR_OFFMKT_MSTR WHERE EOFFM_CREATED_DT  BETWEEN  CONVERT(VARCHAR,CONVERT(DATETIME, @PA_FROM_DT,103),106)+' 00:00:00' 
AND CONVERT(VARCHAR,CONVERT(DATETIME,@PA_TO_DT,103),106)+' 23:59:59'   AND EOFFM_DELETED_IND=1
and isnull(EOFFM_BATCH_NO,'')=''


END

GO
