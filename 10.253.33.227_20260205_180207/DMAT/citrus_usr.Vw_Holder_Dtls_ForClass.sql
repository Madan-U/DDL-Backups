-- Object: VIEW citrus_usr.Vw_Holder_Dtls_ForClass
-- Server: 10.253.33.227 | DB: DMAT
--------------------------------------------------


CREATE VIEW [citrus_usr].[Vw_Holder_Dtls_ForClass]    
AS    
    
SELECT distinct DPAM_SBA_NO,DPAM_SBA_NAME,DPAM_BBO_CODE,B.*,  
CASE WHEN ISNULL(DPPD_MASTER_ID,'0')='0' THEN 'N' ELSE 'Y' END POAFLAG ,CLIM_DOB,CLIM_CRN_NO ,  
case when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Business' then '1'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Services' then '2'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Professional' then '3'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Aggriculture' then '4'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Retired' then '5'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Housewife' then '6'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Student' then '7'
when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'OCCUPATION',''),'')='Others' then '8' end  OCCUPATION_CODE  
,
case when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'TAX_DEDUCTION',''),'')= 'Individual' then '1'
 when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'TAX_DEDUCTION',''),'')= 'On behalf of minor' then '2'
 when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'TAX_DEDUCTION',''),'')= 'HUF' then '3'
 when ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'TAX_DEDUCTION',''),'')= 'Company' then '4' end TAX_STATUS  
,ISNULL(CITRUS_USR.FN_UCC_ENTP(CLIM_CRN_NO,'PAN_GIR_NO',''),'') PAN_NO  
FROM CLIENT_MSTR, DP_ACCT_MSTR,DP_HOLDER_DTLS B LEFT OUTER JOIN   
DP_POA_DTLS ON DPPD_DPAM_ID=DPHD_DPAM_ID AND DPHD_DELETED_IND=1 AND DPPD_DELETED_IND=1  
WHERE DPAM_ID=DPHD_DPAM_ID AND DPHD_DELETED_IND=1 AND DPAM_DELETED_IND=1    
AND CLIM_CRN_NO=DPAM_CRN_NO AND CLIM_DELETED_IND=1

GO
