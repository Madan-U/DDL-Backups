-- Object: VIEW dbo.VW_ISIN_CLOSEPRICE
-- Server: 10.253.78.167 | DB: inhouse
--------------------------------------------------

CREATE VIEW [dbo].[VW_ISIN_CLOSEPRICE] 
AS
SELECT I.*, V.RATE_DATE, R.CLOSE_PRICE
FROM
(SELECT ISIN, COMP_NAME FROM VW_ISIN_MASTER WITH (NOLOCK)) I
INNER JOIN
(SELECT MAX(RATE_DATE) AS RATE_DATE, ISIN FROM VW_ISIN_RATE_MASTER WITH (NOLOCK) GROUP BY ISIN) V
ON (I.ISIN = V.ISIN)
INNER JOIN
VW_ISIN_RATE_MASTER R WITH (NOLOCK)
ON (V.RATE_DATE = R.RATE_DATE AND V.ISIN = R.ISIN)

GO
