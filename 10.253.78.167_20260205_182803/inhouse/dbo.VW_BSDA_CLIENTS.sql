-- Object: VIEW dbo.VW_BSDA_CLIENTS
-- Server: 10.253.78.167 | DB: inhouse
--------------------------------------------------


           
CREATE VIEW [dbo].[VW_BSDA_CLIENTS]        
AS         
SELECT
	NISE_PARTY_CODE,CLIENT_CODE,
	NEXT_AMC_DATE,TEMPLATE_CODE 
FROM 
	TBL_CLIENT_MASTER WITH (NOLOCK)  
WHERE  
	(LEFT(LTRIM(RTRIM(TEMPLATE_CODE)),4) <> 'ZERO' AND 
	LEFT(LTRIM(RTRIM(TEMPLATE_CODE)),3) <> 'LIF') AND 
	LEFT(LTRIM(RTRIM(TEMPLATE_CODE)),4) <> 'BSDA'  
	AND MONTH(NEXT_AMC_DATE) = MONTH(GETDATE())
	AND YEAR(NEXT_AMC_DATE) = YEAR(GETDATE())  
	AND (CLIENT_CODE IS NOT NULL  
	AND NISE_PARTY_CODE IS NOT NULL AND NISE_PARTY_CODE <> '0')  
	AND LEN(CLIENT_CODE) = 16  
	AND UPPER(LTRIM(RTRIM(TYPE))) = 'INDIVIDUAL'  
	AND UPPER(STATUS) ='ACTIVE'  
GROUP BY 
	NISE_PARTY_CODE,CLIENT_CODE,
	TEMPLATE_CODE,NEXT_AMC_DATE

GO
