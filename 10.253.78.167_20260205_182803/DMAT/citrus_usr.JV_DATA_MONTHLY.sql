-- Object: PROCEDURE citrus_usr.JV_DATA_MONTHLY
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

 
  --EXEC JV_DATA_MONTHLY 'JUL  1 2021','JUL 22 2021'
 
 CREATE PROCEDURE [citrus_usr].[JV_DATA_MONTHLY]
 (
 @FROMDATE VARCHAR(30),
 @TODATE   VARCHAR(30)
)
AS
BEGIN
 

 EXEC [196.1.115.159].msdb.DBO.SP_START_JOB 'MONTHLY_JV_DATA' 
 WAITFOR DELAY '00:0:45';

 
SELECT LD_CLIENTCD,LD_DT,LD_AMOUNT,LD_PARTICULAR,LD_CHEQUENO,LD_DEBITFLAG,LD_DOCUMENTTYPE,LD_DOCUMENTNO,MKRID,MKRDT,LD_ACCYEAR,LD_DPID,FIRST_HOLD_STATE
 
 FROM SYNERGY_LEDGER A WITH(NOLOCK),TBL_CLIENT_MASTER B WITH(NOLOCK) WHERE 
 (LD_PARTICULAR like 'BEING THE DPAMC%'OR LD_PARTICULAR like 'BEING THE DP TRANSACTION%'OR LD_PARTICULAR like 'BEING DP AMC%' )
AND LD_DT>=@FROMDATE AND LD_DT<=@TODATE + ' 23:59'    AND A.LD_CLIENTCD=B.CLIENT_CODE
AND LD_CLIENTCD IN (SELECT * FROM  SSRS_CLIENTID) 
END

GO
