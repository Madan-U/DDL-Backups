-- Object: PROCEDURE citrus_usr.PR_IMPORT_DPU9
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------


CREATE PROCEDURE [citrus_usr].[PR_IMPORT_DPU9]
(@PA_EXCH          VARCHAR(20)              
,@PA_LOGIN_NAME    VARCHAR(20)              
,@PA_MODE          VARCHAR(10)                                              
,@PA_DB_SOURCE     VARCHAR(250)              
,@ROWDELIMITER     CHAR(4) =     '*|~*'                
,@COLDELIMITER     CHAR(4) =     '|*~|'                
,@PA_ERRMSG        VARCHAR(8000) OUTPUT )            
AS 
BEGIN 
INSERT INTO DPU9_MSTR
SELECT TDPU9_RECNO
,TDPU9_DPID
,TDPU9_SELLERBO
,TDPU9_SELLERPAN
,TDPU9_SELLERNAME
,TDPU9_BUYERBO
,TDPU9_BUYERPAN
,TDPU9_STATUS_ACTIVEDELINKED
,TDPU9_SETUP_DATE
,TDPU9_LINK_ACTIVATED_DATE
,TDPU9_OTP_DATETIME
,TDPU9_OPERATOR_ID
,TDPU9_SELLERPAN_EXEMPTION_FLAG
,TDPU9_BUYERPAN_EXEMPTION_FLAG
,TDPU9_TRANSACTIONSOURCE_CDAS_EASIEST 
,@PA_LOGIN_NAME
,GETDATE()
,@PA_LOGIN_NAME
,GETDATE()
,1
FROM TMP_DPU9_MSTR WHERE NOT EXISTS (SELECT 1 FROM DPU9_MSTR WHERE TDPU9_SELLERBO=DPU9_SELLERBO AND TDPU9_BUYERBO=DPU9_BUYERBO 
AND TDPU9_STATUS_ACTIVEDELINKED=DPU9_STATUS_ACTIVEDELINKED AND TDPU9_LINK_ACTIVATED_DATE=DPU9_LINK_ACTIVATED_DATE)
END

GO
