-- Object: PROCEDURE citrus_usr.CLIENT_MASTER_INSERT
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

CREATE PROCEDURE CLIENT_MASTER_INSERT
AS
BEGIN


SELECT BOID INTO #TEMP FROM dps8_pc1 WITH(NOLOCK) WHERE  NOT EXISTS (SELECT CLIENT_CODE FROM TBL_CLIENT_MASTER WITH(NOLOCK) WHERE boid=CLIENT_CODE)

SELECT  * into #SYNERGY_CLIENT_MASTER FROM Synergy_Client_Master_fordump WHERE CM_CD  in (select * from #temp)
 

SELECT  * into #TBL_CLIENT_MASTER FROM TBL_Client_Master_fordump WHERE CLIENT_CODE in (select * from #temp)
 
 --------------------------------


DELETE FROM Synergy_Client_Master  WHERE CM_CD  in (select CM_cD FROM #SYNERGY_CLIENT_MASTER)



DELETE FROM TBL_Client_Master  WHERE CLIENT_CODE in (select CLIENT_CODE FROM #TBL_CLIENT_MASTER)


INSERT INTO SYNERGY_CLIENT_MASTER  
SELECT * FROM #SYNERGY_CLIENT_MASTER  

 INSERT INTO TBL_CLIENT_MASTER
 SELECT * FROM  #TBL_CLIENT_MASTER


  END

GO
