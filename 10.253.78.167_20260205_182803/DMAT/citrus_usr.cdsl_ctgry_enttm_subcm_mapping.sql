-- Object: FUNCTION citrus_usr.cdsl_ctgry_enttm_subcm_mapping
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

/*SELECT DISTINCT TMPCLI_ACCT_CTRGY FROM TMP_CLIENT_DTLS_MSTR_CDSL TCDMC          
SELECT DISTINCT ENTTM_DESC,ENTTM_CD FROM ENTITY_TYPE_MSTR          
          
SELECT DISTINCT TMPCLI_BO_STAT  FROM TMP_CLIENT_DTLS_MSTR_CDSL TCDMC          
SELECT CLICM_DESC, CLICM_CD FROM CLIENT_CTGRY_MSTR          
          
SELECT DISTINCT TMPCLI_BO_SUB_STAT  FROM TMP_CLIENT_DTLS_MSTR_CDSL TCDMC          
SELECT DISTINCT SUBCM_DESC,SUBCM_CD FROM SUB_CTGRY_MSTR  ORDER BY SUBCM_DESC          
*/          
--SELECT CITRUS_USR.CDSL_CTGRY_ENTTM_SUBCM_MAPPING('CLEARING MEMBER ACCOUNT','ENTTM')          
CREATE FUNCTION [citrus_usr].[cdsl_ctgry_enttm_subcm_mapping](@PA_DESC VARCHAR(100),@PA_TYPE VARCHAR(10))          
RETURNS VARCHAR(50)          
AS          
BEGIN          
 --          
   DECLARE @L_CD VARCHAR(50)          
   IF @PA_TYPE = 'ENTTM'          
   SET @L_CD  = CASE WHEN @PA_DESC = 'CLEARING MEMBER ACCOUNT' THEN '14_CDSL'          
                WHEN @PA_DESC = 'CM POOL' THEN '12_CDSL'          
       WHEN @PA_DESC = 'CM PRINCIPAL' THEN '02_CDSL'          
       WHEN @PA_DESC = 'REGULAR BO' THEN '01_CDSL'          
                END          
   IF @PA_TYPE = 'CLICM'          
   SET @L_CD  = CASE WHEN @PA_DESC = 'CLEARING MEMBER' THEN '26'          
                WHEN @PA_DESC = 'CORPORATE' THEN '25'          
       WHEN @PA_DESC = 'INDIVIDUAL' THEN '21'          
       WHEN @PA_DESC = 'FI' THEN '22'          
       WHEN @PA_DESC = 'FII' THEN '23'          
       WHEN @PA_DESC = 'FOREIGN NATIONAL' THEN '27'          
       WHEN @PA_DESC = 'MUTUAL FUNDS' THEN '28'          
                WHEN @PA_DESC = 'TRUSTS' THEN '29'          
                WHEN @PA_DESC = 'BANK' THEN '30_CDSL'          
                WHEN @PA_DESC = 'NRI' THEN '24' END          
             
   IF @PA_TYPE = 'SUBCM'          
   SET @L_CD  = CASE WHEN @PA_DESC = 'CLEARING MEMBER' THEN '192624'          
                     WHEN @PA_DESC = 'CORPORATE BODY-DOMESTIC' THEN '022512'          
         WHEN @PA_DESC = 'INDIVIDUAL-DIRECTOR' THEN '012101'          
         WHEN @PA_DESC = 'INDIVIDUAL-RESIDENT' THEN '012103'     
WHEN @PA_DESC = 'INDIVIDUAL-DIRECTORS RELATIVES' then '012102'     
         WHEN @PA_DESC = 'INDIVIDUAL RESIDENT- PMS' THEN '012173'         
         WHEN @PA_DESC = 'INDIVIDUAL-COMMODITY-HUF' THEN '392180'      
     WHEN @PA_DESC = 'INDIVIDUAL RESIDENT-PMS NEGATIVE NOMINATION' THEN '012181' 
WHEN @PA_DESC = 'PMS Negative Nomination' then      '012181' 
       WHEN @PA_DESC = 'NRI-NON REPATRIABLE' THEN '032411'          
         WHEN @PA_DESC = 'NRI-REPATRIABLE' THEN '032410'          
         WHEN @PA_DESC = 'INDIVIDUAL-DIRECTORS RELATIVE' THEN '012102'          
         WHEN @PA_DESC = 'INDIVIDUAL-HUFS/AOPS' THEN '082104'          
  WHEN @PA_DESC = 'INDIVIDUAL-HUFS' THEN '082104'      
  WHEN @PA_DESC = 'INDIVIDUAL-HUF' THEN '082104'      
         WHEN @PA_DESC = 'INDIVIDUAL-PROMOTERS' THEN '012140'          
         WHEN @PA_DESC = 'INDIVIDUAL-MARGIN TRADING ACCOUNT' THEN '362142'          
         WHEN @PA_DESC = 'INDIVIDUAL-COMMODITY' THEN '392144'          
         WHEN @PA_DESC = 'INDIVIDUAL-HUF-MARGIN TRADING ACCOUNT' THEN '082147'          
         WHEN @PA_DESC = 'FI-GOVT SPONSORED FI' THEN '052205'        
         WHEN @PA_DESC = 'FI-SFC' THEN '042206'            
         WHEN @PA_DESC = 'FI-OTHERS' THEN '042207'            
         WHEN @PA_DESC = 'FII-MAURITIUS BASED' THEN '052308'            
         WHEN @PA_DESC = 'FII-OTHERS' THEN '052309'            
         WHEN @PA_DESC = 'FII-DEPOSITARY RECEIPT' THEN '052334'            
         WHEN @PA_DESC = 'NRI REPATRIABLE' THEN '2448'            
         WHEN @PA_DESC = 'NRI NON REPATRIABLE' THEN '032411'            
         WHEN @PA_DESC = 'NRI-DEPOSITARY RECEIPT' THEN '032435'            
         WHEN @PA_DESC = 'CORPORATE BODY-DOMESTIC' THEN '022512'            
         WHEN @PA_DESC = 'CORPORATE BODY-OCB' THEN '022513'            
         WHEN @PA_DESC = 'CORPORATE BODY-GOVERNMENT CO.' THEN '022514'            
         WHEN @PA_DESC = 'CORPORATE BODY-CENTRAL GOVERNMENT' THEN '022515'           
         WHEN @PA_DESC = 'CORPORATE BODY-STATE GOVT' THEN '022516'            
         WHEN @PA_DESC = 'CORPORATE BODY-CO-OPERATIVE BANK' THEN '022517'           
         WHEN @PA_DESC = 'CORPORATE BODY-NBFC' THEN '022518'            
         WHEN @PA_DESC = 'CORPORATE BODY-NON NBFC' THEN '022519'           
         WHEN @PA_DESC = 'CORPORATE BODY-BROKER' THEN '022520'            
         WHEN @PA_DESC = 'CORPORATE BODY-GROUP COMPANY' THEN '022521'           
         WHEN @PA_DESC = 'CORPORATE BODY-FOREIGN BODIES' THEN '022522'            
         WHEN @PA_DESC = 'CORPORATE BODY-OTHERS' THEN '022523'           
         WHEN @PA_DESC = 'CORPORATE BODY-OCB-DEPOSITORY RECEIPT' THEN '022536'            
         WHEN @PA_DESC = 'CORPORATE BODY-DEPOSITORY RECEIPT' THEN '022538'           
         WHEN @PA_DESC = 'CORPORATE BODY-PROMOTER' THEN '022541'            
         WHEN @PA_DESC = 'CORPORATE-MARGIN TRADING ACCOUNT' THEN '022551'           
         WHEN @PA_DESC = 'CORPORATE-COMMODITY' THEN '022545'            
         WHEN @PA_DESC = 'CLEARING MEMBER' THEN '0600'           
         WHEN @PA_DESC = 'FOREIGN NATIONAL ' THEN '182725'       
  WHEN @PA_DESC = 'CORPORATE BODY-CENTRAL GOVT' THEN '022515'       
  WHEN @PA_DESC = 'CORPORATE BODY-CO OPERATIVE BANK' THEN '022517'       
          
         WHEN @PA_DESC = 'FOREIGN NATIONAL-DEPOSITARY RECEIPT' THEN '182737'           
         WHEN @PA_DESC = 'MUTUAL FUND' THEN '062826'         
         WHEN @PA_DESC = 'TRUSTS' THEN '242927'         
         WHEN @PA_DESC = 'BANK-FOREIGN' THEN '073028'         
         WHEN @PA_DESC = 'BANK-CO-OPERATIVE' THEN '073029'         
         WHEN @PA_DESC = 'BANK-NATIONALISED' THEN '073030'         
         WHEN @PA_DESC = 'BANK-OTHERS' THEN '073031'         
         WHEN @PA_DESC = 'BANK-DEPOSITARY RECEIPT' THEN '073039'         
         WHEN @PA_DESC = 'BANK-COMMODITY' THEN '413046'        
   WHEN @PA_DESC = 'CORPORATE CM/TM - CLIENT BENEFICIARY A/C' THEN '022552'      
   WHEN @PA_DESC = 'CORPORATE CM/TM - CLIENT MARGIN A/C' THEN '022551'      
         WHEN @PA_DESC = 'RESIDENT INDIVIDUAL - MINOR' THEN '012158'       
         WHEN @PA_DESC = 'RESIDENT NON RESIDENT INDIAN - MINOR' THEN '032458'      
         WHEN @PA_DESC = 'RESIDENT FOREIGN NATIONAL - MINOR' THEN '182758'      
         WHEN @PA_DESC = 'ASSOCIATION OF PERSONS [AOP]' THEN '012168'      
         WHEN @PA_DESC = 'INDIVIDUAL- RESIDENT NEGATIVE NOMINATION' THEN '012169'      
         WHEN @PA_DESC = 'NRI REPATRIABLE NEGATIVE NOMINATION' THEN '032470'      
         WHEN @PA_DESC = 'NRI NON-REPATRIABLE NEGATIVE NOMINATION' THEN '032471' 
		 WHEN @PA_DESC = 'NRI NON REPATRIABLE NEGATIVE NOMINATION'    then '032471'  
         WHEN @PA_DESC = 'FOREIGN NATIONAL NEGATIVE NOMINATION' THEN '182772'       
    
-- NEW ADDED    
    
         WHEN @PA_DESC = 'INDIVIDUAL RESIDENT- PMS' THEN '012173'      
         WHEN @PA_DESC = 'IND RESIDENT-PMS NEGATIVE NOMINATION' THEN '012181'      
         WHEN @PA_DESC = 'HUF - PMS' THEN '012182'      
         WHEN @PA_DESC = 'INDIVIDUAL PROMOTERS NEGATIVE NOMINATION' THEN '012184'      
         WHEN @PA_DESC = 'CORPORATE BODY - DOMESTIC - PMS' THEN '022576'       
  WHEN @PA_DESC = 'NRI REPATRIABLE - PMS' THEN '032474'       
  WHEN @PA_DESC = 'NRI NON REPATRIABLE - PMS' THEN '032475'       
--    
  WHEN @PA_DESC = 'TRUST - PMS' THEN '242977'       
                 END          
             
   RETURN ISNULL(@L_CD,'')          
 --          
END

GO
