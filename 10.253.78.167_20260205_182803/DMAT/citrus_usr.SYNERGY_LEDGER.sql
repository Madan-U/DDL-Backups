-- Object: VIEW citrus_usr.SYNERGY_LEDGER
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

  
  
        
        
        
        
        
        
CREATE  VIEW [citrus_usr].[SYNERGY_LEDGER]            
            
AS            
        
SELECT  CASE WHEN LDG_ACCOUNT_TYPE ='P' THEN DPAM_SBA_NO ELSE        
CASE WHEN FINA_ACC_CODE LIKE '%SGST' THEN 'SGST'        
WHEN FINA_ACC_CODE LIKE '%IGST' THEN 'IGST'        
WHEN FINA_ACC_CODE LIKE '%CGST' THEN 'CGST'        
WHEN FINA_ACC_CODE LIKE '%UGST' THEN 'UGST'        
ELSE FINA_ACC_CODE END        
END LD_CLIENTCD           
,LDG_VOUCHER_DT  LD_DT           
,CONVERT(NUMERIC(18,4),LDG_AMOUNT  ) LD_AMOUNT           
,LDG_NARRATION  LD_PARTICULAR           
,LDG_INSTRUMENT_NO  LD_CHEQUENO           
,CASE WHEN LDG_AMOUNT < 0 THEN 'D' ELSE 'C' END   LD_DEBITFLAG           
,(CASE WHEN LDG_VOUCHER_TYPE =1 THEN 'P'           
       WHEN LDG_VOUCHER_TYPE =2 THEN 'R'           
    WHEN LDG_VOUCHER_TYPE =3 THEN 'J'           
    WHEN LDG_VOUCHER_TYPE =5 THEN 'B' ELSE '' END) LD_DOCUMENTTYPE           
,LDG_VOUCHER_NO  LD_DOCUMENTNO           
,'' LD_ENTRYNO           
,'' LD_COSTCENTER           
,LDG_CREATED_BY  MKRID           
,LDG_LST_UPD_DT  MKRDT           
,YEAR(LDG_VOUCHER_DT) LD_ACCYEAR           
,LEFT(DPAM_SBA_NO,8) LD_DPID           
,'' LD_COMMONDT           
,'' LD_COMMON           
FROM ledger11   WITH(NOLOCK)         
LEFT OUTER JOIN  DP_ACCT_MSTR  WITH(NOLOCK)ON  LDG_ACCOUNT_ID  = DPAM_ID            
LEFT OUTER JOIN  FIN_ACCOUNT_MSTR   WITH(NOLOCK)ON  LDG_ACCOUNT_ID  =   FINA_ACC_ID            
WHERE LDG_DELETED_IND=1 AND LDG_NARRATION <>'OPENING BALANCE'       
----CHANGES DONE UNDER SRE_35452 YEAR END PROCESS  
  UNION ALL  
  SELECT  CASE WHEN LDG_ACCOUNT_TYPE ='P' THEN DPAM_SBA_NO ELSE        
CASE WHEN FINA_ACC_CODE LIKE '%SGST' THEN 'SGST'        
WHEN FINA_ACC_CODE LIKE '%IGST' THEN 'IGST'        
WHEN FINA_ACC_CODE LIKE '%CGST' THEN 'CGST'        
WHEN FINA_ACC_CODE LIKE '%UGST' THEN 'UGST'        
ELSE FINA_ACC_CODE END        
END LD_CLIENTCD           
,LDG_VOUCHER_DT  LD_DT           
,CONVERT(NUMERIC(18,4),LDG_AMOUNT  ) LD_AMOUNT           
,LDG_NARRATION  LD_PARTICULAR           
,LDG_INSTRUMENT_NO  LD_CHEQUENO           
,CASE WHEN LDG_AMOUNT < 0 THEN 'D' ELSE 'C' END   LD_DEBITFLAG           
,(CASE WHEN LDG_VOUCHER_TYPE =1 THEN 'P'           
       WHEN LDG_VOUCHER_TYPE =2 THEN 'R'           
    WHEN LDG_VOUCHER_TYPE =3 THEN 'J'           
    WHEN LDG_VOUCHER_TYPE =5 THEN 'B' ELSE '' END) LD_DOCUMENTTYPE           
,LDG_VOUCHER_NO  LD_DOCUMENTNO           
,'' LD_ENTRYNO           
,'' LD_COSTCENTER           
,LDG_CREATED_BY  MKRID           
,LDG_LST_UPD_DT  MKRDT           
,YEAR(LDG_VOUCHER_DT) LD_ACCYEAR           
,LEFT(DPAM_SBA_NO,8) LD_DPID           
,'' LD_COMMONDT           
,'' LD_COMMON           
FROM LEDGER12   WITH(NOLOCK)         
LEFT OUTER JOIN  DP_ACCT_MSTR  WITH(NOLOCK)ON  LDG_ACCOUNT_ID  = DPAM_ID            
LEFT OUTER JOIN  FIN_ACCOUNT_MSTR   WITH(NOLOCK)ON  LDG_ACCOUNT_ID  =   FINA_ACC_ID            
WHERE LDG_DELETED_IND=1 AND LDG_NARRATION <>'OPENING BALANCE'

GO
