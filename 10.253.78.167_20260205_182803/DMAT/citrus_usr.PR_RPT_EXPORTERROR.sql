-- Object: PROCEDURE citrus_usr.PR_RPT_EXPORTERROR
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

CREATE  PROC [citrus_usr].[pr_rpt_exporterror] (@PA_FROM_DT DATETIME, @PA_TO_DT DATETIME    
,@PA_LOGIN_NAME VARCHAR(100)    
)          
AS  
BEGIN 
SELECT 'COUNTER BOID NOT PROPER' [DESC],  ''''+DPTDC_SLIP_NO [SLIP NO ] FROM DP_TRX_DTLS_CDSL WHERE DPTDC_REQUEST_DT = @PA_FROM_DT
AND LEN(DPTDC_COUNTER_DEMAT_ACCT_NO) <> '8'
AND LEN(DPTDC_COUNTER_DEMAT_ACCT_NO) <> '16'
AND DPTDC_COUNTER_DEMAT_ACCT_NO <> '' 
union 
SELECT 'COUNTER BOID NOT PROPER' [DESC],  ''''+DPTDC_SLIP_NO [SLIP NO ] 
FROM DP_TRX_DTLS_CDSL WHERE DPTDC_REQUEST_DT = @PA_FROM_DT
AND isnull(DPTDC_COUNTER_DEMAT_ACCT_NO,'') = '' 
and dptdC_trastm_cd = 'BOBO'
union 
SELECT 'COUNTER DPID NOT PROPER' [DESC],  ''''+DPTDC_SLIP_NO [SLIP NO ] 
FROM DP_TRX_DTLS_CDSL WHERE DPTDC_REQUEST_DT = @PA_FROM_DT
AND isnull(DPTDC_COUNTER_DP_ID,'') = '' 
and dptdC_trastm_cd = 'BOBO'	

union 
SELECT 'SPECIAL CHARACTER AVAILABLE IN DIS' [DESC],  ''''+DPTDC_SLIP_NO [SLIP NO ] 
FROM DP_TRX_DTLS_CDSL WHERE DPTDC_REQUEST_DT = @PA_FROM_DT
and isnull( DPTDC_TRANSFEREENAME,'') <> ''
and   (DPTDC_TRANSFEREENAME like '%&%' or DPTDC_TRANSFEREENAME like '%@%')

 
END

GO
