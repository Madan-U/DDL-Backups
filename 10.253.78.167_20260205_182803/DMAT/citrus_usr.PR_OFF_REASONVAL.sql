-- Object: PROCEDURE citrus_usr.PR_OFF_REASONVAL
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

--Exec PR_OFF_REASONVAL '1208860000000019','40','1208860000000042'
create  PROCEDURE [citrus_usr].[PR_OFF_REASONVAL](@PA_BOID VARCHAR(16),@PA_REASONCODE VARCHAR(50),@PA_TRGBOID VARCHAR(16),@pa_ref_cur varchar(10) output)
AS
BEGIN
DECLARE @L_RTR VARCHAR(50)
IF @PA_REASONCODE='40'
BEGIN
SELECT @L_RTR=1 FROM DP_ACCT_MSTR,SUB_CTGRY_MSTR WHERE 
 DPAM_SUBCM_CD=SUBCM_CD
AND SUBCM_DELETED_IND=1 
AND DPAM_DELETED_IND=1
AND SUBCM_CD  not IN (
 '6025158','6025160','6025161','0526','0525','0524','0523','0522','0521','0520','0519','0518','0517','0529','0530','0225158','6025158'
,'022517','1008','1007','1006','1005','1003','1002','1001','413046','073039','073031','073030','073029','073028','0730119','062826','0802','0801','0800'
)
AND DPAM_SBA_NO in (@PA_BOID,@PA_TRGBOID)
--AND @PA_REASONCODE=40
END
IF @PA_REASONCODE='41'
BEGIN
SELECT @L_RTR=1 FROM DP_ACCT_MSTR,SUB_CTGRY_MSTR WHERE 
 DPAM_SUBCM_CD=SUBCM_CD
AND SUBCM_DELETED_IND=1 
AND DPAM_DELETED_IND=1
AND SUBCM_CD  not IN (
 '6025158','6025160','6025161','0526','0525','0524','0523','0522','0521','0520','0519','0518','0517','0529','0530','0225158','6025158'
,'022517','1008','1007','1006','1005','1003','1002','1001','413046','073039','073031','073030','073029','073028','0730119','062826','0802','0801','0800'
)
AND DPAM_SBA_NO in (@PA_TRGBOID) -- @PA_BOID,
--AND @PA_REASONCODE=40
END

SELECT isnull(@L_RTR,'0') RTNVAL
END 

--SELECT * FROM SUB_CTGRY_MSTR WHERE SUBCM_DESC LIKE '%MUTUAL%'

--select * from DP_ACCT_MSTR

--select * from SLIP_ISSUE_MSTR where SLIIM_DPAM_ACCT_NO='1208860000000019'

GO
