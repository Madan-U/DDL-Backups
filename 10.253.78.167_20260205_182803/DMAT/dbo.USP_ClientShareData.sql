-- Object: PROCEDURE dbo.USP_ClientShareData
-- Server: 10.253.78.167 | DB: DMAT
--------------------------------------------------

CREATE PROCEDURE USP_ClientShareData

AS
exec USP_ClientShareData;
BEGIN

--select * INTO #Tempdataa  from  [172.31.16.94].dMAT.DBO.SYNERGY_TRXN_DETAILS as TD with(nolock) 
--WHERE TD.TD_DEBIT_CREDIT ='C' 
--AND LEFT(TD.TD_BENEFICIERY,8)<>'12033200'
--AND TD.TD_BENEFICIERY <>''
--AND TD.TD_CURDATE > dateadd(m,-9, GETDATE());



SELECT * 
FROM   INFORMATION_SCHEMA.VIEWS 
WHERE  VIEW_DEFINITION like '%SYNERGY_TRXN_DETAILS%'


select 
TD_CURDATE
--,TD_AC_CODE,TD_ISIN_CODE
--,TD_CURDATE,TD_AC_CODE,TD_ISIN_CODE,
--TD_QTY,TD_CLEAR_CORPN,TD_COUNTERDP,
--TD_BENEFICIERY,TD_REFERENCE,TD_DESCRIPTION,
--TD_CATEGORY,TD_AC_TYPE,TD_NARRATION,
--TD_BOOKING_TYPE,TD_MARKET_TYPE,TD_SETTLEMENT,
--TD_BLOCKED,TD_BLOCKEDCD,TD_RDATE,
--TD_TRXDATE,TD_TRXTIME,TD_DEBIT_CREDIT,
--TD_TRXNO,TD_CHARGE_CODE,TD_RATE,
--TD_AMOUNT,TD_INTERNAL_REFNO,TD_COUNTERCMBPID,
--TD_TOTCERT,TD_CHARGEFLAG,MKRID,MKRDT,TD_REJCODE,
--TD_BILLCODE,TD_CDSLCHARGE,TD_PDCD,TD_PDCODE,
--TD_REMARKS,TD_ACTUALCDSLCHARGE
 from SYNERGY_TRXN_DETAILS
 WHERE TD_DEBIT_CREDIT ='C' 
AND LEFT(TD_BENEFICIERY,8)<>'12033200'
AND TD_BENEFICIERY <>''
AND TD_CURDATE > dateadd(m,-9, GETDATE());


--select * into #TempData1 from [172.31.16.94].dMAT.DBO.TBL_CLIENT_MASTER as CM with(nolock);

--select Count(*) from TBL_CLIENT_MASTER;

--select * from #Tempdataa as TD
--INNER JOIN #TempData1 as CM ON (CM.CLIENT_CODE = TD.TD_AC_CODE)
--INNER JOIN ANAND1.MSAJAG.DBO.CMBILLVALAN S 
--ON CM.NISE_PARTY_CODE = S.PARTY_CODE INNER JOIN ANAND.BSEDB_AB.DBO.CMBILLVALAN S1
--ON S1.PARTY_CODE = S.PARTY_CODE;

   
END

GO
