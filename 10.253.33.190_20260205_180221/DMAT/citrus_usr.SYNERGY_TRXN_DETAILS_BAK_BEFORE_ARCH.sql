-- Object: VIEW citrus_usr.SYNERGY_TRXN_DETAILS_BAK_BEFORE_ARCH
-- Server: 10.253.33.190 | DB: DMAT
--------------------------------------------------



CREATE VIEW [citrus_usr].[SYNERGY_TRXN_DETAILS_BAK_BEFORE_ARCH]
AS
SELECT CDSHM_TRAS_DT TD_CURDATE, cdshm_ben_Acct_no TD_AC_CODE, cdshm_isin TD_ISIN_CODE, 
		CASE 
		WHEN cdshm_qty < 0
			THEN cdshm_qty * - 1
		ELSE cdshm_qty
		END TD_QTY, '' TD_CLEAR_CORPN, LEFT(CDSHM_COUNTER_DPID, 16) TD_COUNTERDP, LEFT(ISNULL(CDSHM_COUNTER_BOID, CDSHM_COUNTER_DPID), 16) TD_BENEFICIERY, CDSHM_TRANS_NO TD_REFERENCE, LEFT(REPLACE(cdshm_tratm_type_desc, 'FILE', ''), 100) TD_DESCRIPTION, NULL TD_CATEGORY, NULL TD_AC_TYPE, NULL TD_NARRATION, NULL TD_BOOKING_TYPE, CDSHM_SETT_TYPE TD_MARKET_TYPE, CDSHM_SETT_NO TD_SETTLEMENT, '0' TD_BLOCKED, '00' TD_BLOCKEDCD, NULL TD_RDATE, LEFT(CONVERT(VARCHAR, CDSHM_TRAS_DT, 112), 8) TD_TRXDATE, '' TD_TRXTIME, 
		CASE 
		WHEN CDSHM_QTY < 0
			THEN 'D'
		ELSE 'C'
		END TD_DEBIT_CREDIT, cdshm_tratm_cd TD_TRXNO, '' TD_CHARGE_CODE, 0 TD_RATE, 0 TD_AMOUNT, '' TD_INTERNAL_REFNO, '' TD_COUNTERCMBPID, 0 TD_TOTCERT, '' TD_CHARGEFLAG, '' MKRID, '' MKRDT, '' TD_REJCODE, '' TD_BILLCODE, 0 TD_CDSLCHARGE, '' TD_PDCD, '' TD_PDCODE, LEFT(CDSHM_TRATM_DESC, 100) TD_REMARKS, 0 TD_ACTUALCDSLCHARGE
FROM CDSL_HOLDING_DTLS WITH (NOLOCK)
WHERE 
CDSHM_TRAS_DT > '31-Mar-2015' And
cdshm_tratm_cd IN ('2246', '2277', '2201', '3102', '2270', '2220', '2262', '2251', '2202', '2205')

GO
