-- Object: PROCEDURE dbo.GETHOLDINGDETAILS_PARTYCODEWISE
-- Server: 10.253.33.231 | DB: DMAT
--------------------------------------------------

CREATE PROC [DBO].[GETHOLDINGDETAILS_PARTYCODEWISE]      
(      
 @PARTYCODE VARCHAR(12)      
)      
AS      
      
 
 Select Client_Code,Nise_party_code Into #CLt from TBL_CLIENT_MASTER with(Nolock) 
 where NISE_PARTY_CODE =@PARTYCODE


      
 SELECT HOLDINGDT,D.CLIENT_CODE,PARTY_CODE,SECURITYNAME,HLD_ISIN_CODE,FREE_QTY,PLEDGE_QTY,PENDIGDEMATREMAT,LOCKINFREEZE,NETQTY,RATE,VALUATION      
 FROM DMAT.CITRUS_USR.HLD_DETAILS D WITH(NOLOCK) ,#CLt C WHERE C.CLIENT_CODE=D.CLIENT_CODE

 Drop table #CLt
  
/*  
SELECT  HOLDINGDT,HLD_AC_CODE AS CLIENT_CODE,TRADINGID  AS PARTY_CODE,SECURITYNAME,HLD_ISIN_CODE,    
(FREE_QTY+AVAIL_LEND_QTY+LEND_QTY+BORROW_QTY)FREE_QTY,    
PLEDGE_QTY,(DEMAT_PND_VER_QTY+REMAT_PND_CONF_QTY+DEMAT_PND_CONF_QTY)PENDIGDEMATREMAT,    
(FREEZE_QTY+SAFE_KEEPING_QTY+LOCKIN_QTY+ELIMINATION_QTY+EARMARK_QTY)LOCKINFREEZE    
,NETQTY,RATE,VALUATION    
 FROM DMAT.CITRUS_USR.HOLDING H WITH(NOLOCK)   
  
*/

GO
