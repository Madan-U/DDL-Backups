-- Object: PROCEDURE citrus_usr.PR_INS_UPD_ERR_OFFMKT
-- Server: 10.253.78.187 | DB: DMAT
--------------------------------------------------



create PROCEDURE [citrus_usr].[PR_INS_UPD_ERR_OFFMKT]
(
@PA_ID NUMERIC
,@PA_ACTION VARCHAR(100)
,@PA_LOGIN_NAMES VARCHAR(100)
,@PA_EOFFM_SELLER_BOID VARCHAR(16)
,@PA_EOFFM_BO_TYPE CHAR(1)
,@PA_EOFFM_BOID VARCHAR(16)
,@PA_EOFFM_EXEM_FLAG CHAR(1)
,@PA_EOFFM_BUYER_PAN VARCHAR(10)
,@PA_ERRMSG varchar(800) output
)
AS
BEGIN
IF @PA_ACTION='INS'
BEGIN
INSERT INTO ERR_OFFMKT_MSTR
SELECT @PA_EOFFM_SELLER_BOID 
,@PA_EOFFM_BO_TYPE
,@PA_EOFFM_BOID 
,@PA_EOFFM_EXEM_FLAG 
,@PA_EOFFM_BUYER_PAN 
, @PA_LOGIN_NAMES
,GETDATE()
,@PA_LOGIN_NAMES
,GETDATE()
,1
,''
WHERE NOT EXISTS (
SELECT 1 FROM ERR_OFFMKT_MSTR WHERE EOFFM_SELLER_BOID=@PA_EOFFM_SELLER_BOID 
AND EOFFM_BOID=@PA_EOFFM_BOID )
END

IF @PA_ACTION='UPD'
BEGIN
UPDATE ERR_OFFMKT_MSTR 
SET EOFFM_SELLER_BOID =@PA_EOFFM_SELLER_BOID 
,EOFFM_BO_TYPE=@PA_EOFFM_BO_TYPE
,EOFFM_BOID=@PA_EOFFM_BOID 
,EOFFM_EXEM_FLAG =@PA_EOFFM_EXEM_FLAG 
,EOFFM_BUYER_PAN=@PA_EOFFM_BUYER_PAN 
,EOFFM_LST_UPD_BY=@PA_LOGIN_NAMES
,EOFFM_LST_UPD_DT=GETDATE()
WHERE EOFFM_SELLER_BOID =@PA_EOFFM_SELLER_BOID AND EOFFM_BOID=@PA_EOFFM_BOID 

END

IF @PA_ACTION='DEL'
BEGIN
DELETE FROM ERR_OFFMKT_MSTR WHERE EOFFM_SELLER_BOID =@PA_EOFFM_SELLER_BOID AND EOFFM_BOID=@PA_EOFFM_BOID 
END


END

GO
