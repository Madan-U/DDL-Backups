-- Object: FUNCTION citrus_usr.fn_CLASS_Auto_Process_Replace
-- Server: 10.253.78.187 | DB: DMAT
--------------------------------------------------

create FUNCTION [citrus_usr].[fn_CLASS_Auto_Process_Replace]    
(    
 @PARAMETER  VARCHAR(500),     
 @BUSINESS_DATE DATETIME,     
 @MEMBERCODE  VARCHAR(10),    
 @SETT_NO  VARCHAR(7),    
 @SETT_TYPE  VARCHAR(2)    
) RETURNS VARCHAR(500)    
AS    
BEGIN    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATEFOLDER>', CONVERT(VARCHAR,@BUSINESS_DATE,112))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATE106NS>', REPLACE(CONVERT(VARCHAR,@BUSINESS_DATE,106),' ', ''))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATEDDMM>', LEFT(REPLACE(CONVERT(VARCHAR,@BUSINESS_DATE,103),'/',''),4))    
    
     
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATEMMYY>', RIGHT(REPLACE(CONVERT(VARCHAR,@BUSINESS_DATE,3),'/',''),4))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATE103->', REPLACE(CONVERT(VARCHAR,@BUSINESS_DATE,103),'/','-'))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<MON-YEAR>', LEFT(CONVERT(VARCHAR,@BUSINESS_DATE,109),3) + '-' + RIGHT(LEFT(CONVERT(VARCHAR,@BUSINESS_DATE,109),11),4))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATEDDMMYYYY>', REPLACE(CONVERT(VARCHAR,@BUSINESS_DATE,103),'/',''))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATEDDMMYY>', LEFT(REPLACE(CONVERT(VARCHAR,@BUSINESS_DATE,3),'/',''),6))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<MEMBERCODE>', @MEMBERCODE)    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATE109>', '''' + LEFT(CONVERT(VARCHAR,@BUSINESS_DATE,109),11) + '''')    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATE109,>', '''' + LEFT(CONVERT(VARCHAR,@BUSINESS_DATE,109),11) + ''',')     
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<DATE106MMM_YYYY>', '' + REPLACE(RIGHT(LEFT(CONVERT(VARCHAR,@BUSINESS_DATE,106),11),8),' ', '_') + '')    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<SetNo>',@SETT_NO)    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<SetNo3>',RIGHT(@SETT_NO,3))    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<SettType>',@SETT_TYPE)    
    
 IF @SETT_TYPE = 'D'     
 BEGIN    
  SET @PARAMETER = REPLACE(@PARAMETER,'<SettTypeDR>','DR')    
 END    
    
 IF @SETT_TYPE = 'C'     
 BEGIN    
  SET @PARAMETER = REPLACE(@PARAMETER,'<SettTypeDR>','C')    
 END    
    
 IF @SETT_TYPE = 'C'     
 BEGIN    
  SET @PARAMETER = REPLACE(@PARAMETER,'<SettTypePC>','PC')    
 END    
    
 IF @SETT_TYPE = 'D'     
 BEGIN    
  SET @PARAMETER = REPLACE(@PARAMETER,'<SettTypePC>','P')    
 END    
    
 SET @PARAMETER = REPLACE(@PARAMETER,'<BUSINESS_DATE>',LEFT(CONVERT(VARCHAR,@BUSINESS_DATE,109),11))    
    
 RETURN @PARAMETER    
END

GO
