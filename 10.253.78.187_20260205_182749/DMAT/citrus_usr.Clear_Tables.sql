-- Object: PROCEDURE citrus_usr.Clear_Tables
-- Server: 10.253.78.187 | DB: DMAT
--------------------------------------------------

--SELECT * FROM EXCH_SEG_MSTR

--TRUNCATE TABLE  CLIENT_CTGRY_MSTR

--SELECT * FROM CLIENT_CTGRY_MSTR

--SELECT * FROM ENTITY_MSTR


CREATE proc [citrus_usr].[Clear_Tables]
as
Begin

		DECLARE @@NAME  VARCHAR(200),
		@@SSQL VARCHAR(8000),
		@XYZ CURSOR 
		
		SET @XYZ = CURSOR FOR SELECT NAME FROM SYSOBJECTS WHERE TYPE = 'U' 
		AND NAME NOT IN ('LOGIN_NAMES','SCREENS','ACTIONS','ROLES','ROLES_ACTIONS','ENTITY_ROLES','ENTITY_MSTR','ENTITY_TYPE_MSTR','TBLERROR','SCREEN_COMPONENT')
		ORDER BY NAME
		
		OPEN @XYZ
		FETCH NEXT FROM @XYZ INTO @@NAME 
		WHILE @@FETCH_STATUS = 0
		BEGIN
			SET @@SSQL = 'TRUNCATE TABLE ' + @@NAME
			--EXEC(@@SSQL)
			PRINT ' TABLE TRUNCATED -- ' + @@NAME
			SET @@SSQL = 'DELETE FROM ' + @@NAME
			EXEC(@@SSQL)
			PRINT ' TABLE DELETED -- ' + @@NAME

		FETCH NEXT FROM @XYZ INTO @@NAME 
		END
		CLOSE @XYZ
		DEALLOCATE @XYZ
		
end

GO
